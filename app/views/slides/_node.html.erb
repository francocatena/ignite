<% id = dynamic_object_id('node', f) %>
<% hide = is_dynamic || f.object.marked_for_destruction? %>
<div class="node nested_item" id="<%= id %>" <%= raw 'style="display: none;"' if hide %>>
  <div>
    <div class="nested_item_field">
      <%= f.text_area :content %>
    </div>
    <div class="nested_item_field">
      <%= f.text_area :options %>
    </div>
    <div class="nested_item_actions">
      <%= link_to_remove_nested_item(f, :node) %>
      <%= f.hidden_field :rank, :class => :sort_number %>
      <%= f.hidden_field :lock_version %>
    </div>
    <br class="break" />
  </div>
</div>
<% if is_dynamic %>
  <script type="text/javascript">
    Helper.show('#<%= id %>', function() {
      $('textarea[name$="[content]"]', $('#<%= id %>')).focus();
    });
    
    Util.refreshSortNumbers();
  </script>
<% end -%>